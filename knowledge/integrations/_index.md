# Available Integrations

This directory contains documentation for external integrations available in NOVA workflows.

---

## Integration List

### Email

- **[imap.md](imap.md)** - Reading emails, searching inbox, downloading attachments, sender whitelist validation
- **[smtp.md](smtp.md)** - Sending emails with authentication, HTML emails, attachments, reply patterns

### Document Processing

- **[pdf.md](pdf.md)** - Extract text from PDFs, search content, extract images, read forms (PyMuPDF/fitz)
- **[csv.md](csv.md)** - Read/write CSV files, handle delimiters, encoding, convert to dictionaries (Python csv module)
- **[xlsx.md](xlsx.md)** - Read/write Excel files (.xlsx/.xls), multiple sheets, pandas integration (openpyxl, xlrd)

### Database

- **[postgres.md](postgres.md)** - PostgreSQL queries, parameterized statements, transactions, binary data

---

## How Integrations Are Loaded

Integration documentation is loaded **automatically** by the `KnowledgeManager` based on:

1. **Keywords in Task**: If the task mentions "email", "pdf", "database", etc.
2. **Keys in Context**: If context contains `pdf_data`, `db_connection`, etc.

Maximum of **3 integrations** are loaded per code generation to avoid token overflow.

---

## Using Integrations in Generated Code

All integrations follow the same pattern:

1. **Get credentials from NOVA** (if needed):
   ```python
   from src.models.credentials import get_email_credentials, get_database_connection
   ```

2. **Perform operation** with proper error handling:
   ```python
   try:
       # Your integration code
       pass
   except Exception as e:
       print(json.dumps({"status": "error", "message": str(e)}))
   ```

3. **Return structured output** with `context_updates`:
   ```python
   print(json.dumps({
       "status": "success",
       "context_updates": {
           "key": "value"
       },
       "message": "Operation completed"
   }))
   ```

---

**Last Updated**: November 2025
**Generated by**: NOVA Knowledge System
